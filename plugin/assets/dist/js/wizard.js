(()=>{(function(e){"use strict";let d={init:function(){this.bindEvents()},bindEvents:function(){e(document).on("submit",".rp-wizard-form",this.handleFormSubmit.bind(this)),e(document).on("click",".rp-skip-wizard",this.handleSkipWizard.bind(this)),e(document).on("click","#rp-skip-job",this.handleSkipJob.bind(this)),e(document).on("click","#rp-send-test-email",this.handleTestEmail.bind(this))},handleFormSubmit:function(a){a.preventDefault();let r=e(a.currentTarget),t=r.find('button[type="submit"]');t.prop("disabled",!0).text(rpWizard.i18n.saving);let i=new FormData(r[0]);i.append("action","rp_wizard_save_step"),e.ajax({url:rpWizard.ajaxUrl,type:"POST",data:i,processData:!1,contentType:!1,success:function(s){s.success&&s.data.next_url?window.location.href=s.data.next_url:(alert(s.data?.message||rpWizard.i18n.error),t.prop("disabled",!1).text(t.data("original-text")||"Weiter"))},error:function(){alert(rpWizard.i18n.error),t.prop("disabled",!1).text(t.data("original-text")||"Weiter")}})},handleSkipWizard:function(a){a.preventDefault();let r=e(a.currentTarget);r.prop("disabled",!0),e.ajax({url:rpWizard.ajaxUrl,type:"POST",data:{action:"rp_wizard_skip",nonce:rpWizard.nonce},success:function(t){t.success&&t.data.redirect_url?window.location.href=t.data.redirect_url:(alert(t.data?.message||rpWizard.i18n.error),r.prop("disabled",!1))},error:function(){alert(rpWizard.i18n.error),r.prop("disabled",!1)}})},handleSkipJob:function(a){a.preventDefault(),e("#skip_job").val("1"),e("#rp-wizard-job-form").submit()},handleTestEmail:function(a){a.preventDefault();let r=e(a.currentTarget),t=e("#test_email_address"),i=e("#rp-test-email-result"),s=t.val();if(!s){i.removeClass("success").addClass("error").text(rpWizard.i18n.error).show();return}r.prop("disabled",!0).text(rpWizard.i18n.sendingEmail),i.hide(),e.ajax({url:rpWizard.ajaxUrl,type:"POST",data:{action:"rp_send_test_email",nonce:rpWizard.nonce,email:s},success:function(n){n.success?i.removeClass("error").addClass("success").text(n.data.message).show():i.removeClass("success").addClass("error").text(n.data?.message||rpWizard.i18n.emailFailed).show(),r.prop("disabled",!1).text("Test senden")},error:function(){i.removeClass("success").addClass("error").text(rpWizard.i18n.emailFailed).show(),r.prop("disabled",!1).text("Test senden")}})}};e(document).ready(function(){d.init()})})(jQuery);})();
