(()=>{var e={556(e,t,r){e.exports=r(694)()},694(e,t,r){"use strict";var n=r(925);function a(){}function l(){}l.resetWarningCache=a,e.exports=function(){function e(e,t,r,a,l,i){if(i!==n){var o=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw o.name="Invariant Violation",o}}function t(){return e}e.isRequired=e;var r={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:l,resetWarningCache:a};return r.PropTypes=r,r}},925(e){"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"}},t={};function r(n){var a=t[n];if(void 0!==a)return a.exports;var l=t[n]={exports:{}};return e[n](l,l.exports,r),l.exports}r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{"use strict";const e=window.wp.element,t=window.wp.components;var n=r(556),a=r.n(n);const l=window.wp.primitives,i=window.ReactJSXRuntime,o=(0,i.jsx)(l.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,i.jsx)(l.Path,{d:"m19 7-3-3-8.5 8.5-1 4 4-1L19 7Zm-7 11.5H5V20h7v-1.5Z"})}),s=(0,i.jsx)(l.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,i.jsx)(l.Path,{fillRule:"evenodd",clipRule:"evenodd",d:"M5 4.5h11a.5.5 0 0 1 .5.5v11a.5.5 0 0 1-.5.5H5a.5.5 0 0 1-.5-.5V5a.5.5 0 0 1 .5-.5ZM3 5a2 2 0 0 1 2-2h11a2 2 0 0 1 2 2v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5Zm17 3v10.75c0 .69-.56 1.25-1.25 1.25H6v1.5h12.75a2.75 2.75 0 0 0 2.75-2.75V8H20Z"})}),c=(0,i.jsx)(l.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,i.jsx)(l.Path,{d:"M5.5 12h1.75l-2.5 3-2.5-3H4a8 8 0 113.134 6.35l.907-1.194A6.5 6.5 0 105.5 12zm9.53 1.97l-2.28-2.28V8.5a.75.75 0 00-1.5 0V12a.747.747 0 00.218.529l1.282-.84-1.28.842 2.5 2.5a.75.75 0 101.06-1.061z"})}),u=(0,i.jsx)(l.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,i.jsx)(l.Path,{fillRule:"evenodd",clipRule:"evenodd",d:"M12 5.5A2.25 2.25 0 0 0 9.878 7h4.244A2.251 2.251 0 0 0 12 5.5ZM12 4a3.751 3.751 0 0 0-3.675 3H5v1.5h1.27l.818 8.997a2.75 2.75 0 0 0 2.739 2.501h4.347a2.75 2.75 0 0 0 2.738-2.5L17.73 8.5H19V7h-3.325A3.751 3.751 0 0 0 12 4Zm4.224 4.5H7.776l.806 8.861a1.25 1.25 0 0 0 1.245 1.137h4.347a1.25 1.25 0 0 0 1.245-1.137l.805-8.861Z"})});function p({templates:r=[],loading:n=!1,error:a=null,onSelect:l,onDelete:p,onDuplicate:d,onReset:m,onCreate:h}){const[f,g]=(0,e.useState)(""),[b,y]=(0,e.useState)(""),[_,x]=(0,e.useState)(null),[T,v]=(0,e.useState)(null),w=window.rpEmailData?.i18n||{},S=w.categories||{},E=(0,e.useMemo)(()=>r.filter(e=>{if(f){const t=f.toLowerCase();if(!e.name?.toLowerCase().includes(t)&&!e.subject?.toLowerCase().includes(t))return!1}return!b||e.category===b}),[r,f,b]),j=(0,e.useMemo)(()=>{const e=[{value:"",label:w.allCategories||"Alle Kategorien"}];return Object.entries(S).forEach(([t,r])=>{e.push({value:t,label:r})}),e},[S,w.allCategories]),N=e=>{const t=[];return e.is_system&&t.push((0,i.jsx)("span",{className:"rp-badge rp-badge--system",children:w.system||"System"},"system")),e.is_default&&t.push((0,i.jsx)("span",{className:"rp-badge rp-badge--default",children:w.default||"Standard"},"default")),e.is_active||t.push((0,i.jsx)("span",{className:"rp-badge rp-badge--inactive",children:w.inactive||"Inaktiv"},"inactive")),t.length>0?(0,i.jsx)("div",{className:"rp-template-badges",children:t}):null};return n?(0,i.jsx)("div",{className:"rp-template-list__loading",children:(0,i.jsx)(t.Spinner,{})}):(0,i.jsxs)("div",{className:"rp-template-list",children:[a&&(0,i.jsx)(t.Notice,{status:"error",isDismissible:!1,children:a}),(0,i.jsxs)(t.Card,{children:[(0,i.jsx)(t.CardHeader,{children:(0,i.jsxs)("div",{className:"rp-template-list__header",children:[(0,i.jsx)("h2",{children:w.templates||"Templates"}),(0,i.jsx)(t.Button,{variant:"primary",onClick:h,children:w.newTemplate||"Neues Template"})]})}),(0,i.jsxs)(t.CardBody,{children:[(0,i.jsxs)("div",{className:"rp-template-list__filters",children:[(0,i.jsx)(t.SearchControl,{value:f,onChange:g,placeholder:w.searchTemplates||"Templates durchsuchen..."}),(0,i.jsx)(t.SelectControl,{value:b,options:j,onChange:y})]}),0===E.length?(0,i.jsx)("div",{className:"rp-template-list__empty",children:(0,i.jsx)("p",{children:w.noTemplates||"Keine Templates gefunden."})}):(0,i.jsxs)("table",{className:"rp-template-list__table widefat striped",children:[(0,i.jsx)("thead",{children:(0,i.jsxs)("tr",{children:[(0,i.jsx)("th",{children:w.name||"Name"}),(0,i.jsx)("th",{children:w.subject||"Betreff"}),(0,i.jsx)("th",{children:w.category||"Kategorie"}),(0,i.jsx)("th",{children:w.status||"Status"}),(0,i.jsx)("th",{className:"rp-template-list__actions-header",children:w.actions||"Aktionen"})]})}),(0,i.jsx)("tbody",{children:E.map(e=>(0,i.jsxs)("tr",{children:[(0,i.jsx)("td",{children:(0,i.jsx)("button",{type:"button",className:"rp-template-list__name-link",onClick:()=>l&&l(e),children:e.name})}),(0,i.jsx)("td",{children:e.subject}),(0,i.jsx)("td",{children:S[e.category]||e.category}),(0,i.jsx)("td",{children:N(e)}),(0,i.jsxs)("td",{className:"rp-template-list__actions",children:[(0,i.jsx)(t.Button,{icon:o,label:w.editTemplate||"Bearbeiten",onClick:()=>l&&l(e)}),(0,i.jsx)(t.Button,{icon:s,label:w.duplicateTemplate||"Duplizieren",onClick:()=>d&&d(e.id)}),e.is_system&&(0,i.jsx)(t.Button,{icon:c,label:w.resetTemplate||"Zurücksetzen",onClick:()=>(e=>{v(e)})(e)}),!e.is_system&&(0,i.jsx)(t.Button,{icon:u,label:w.deleteTemplate||"Löschen",isDestructive:!0,onClick:()=>(e=>{x(e)})(e)})]})]},e.id))})]})]})]}),_&&(0,i.jsx)(t.__experimentalConfirmDialog,{isOpen:!0,onConfirm:()=>{_&&p&&p(_.id),x(null)},onCancel:()=>x(null),children:w.confirmDelete||"Möchten Sie dieses Template wirklich löschen?"}),T&&(0,i.jsx)(t.__experimentalConfirmDialog,{isOpen:!0,onConfirm:()=>{T&&m&&m(T.id),v(null)},onCancel:()=>v(null),children:w.confirmReset||"Möchten Sie dieses Template auf den Standard zurücksetzen?"})]})}p.propTypes={templates:a().arrayOf(a().shape({id:a().number.isRequired,name:a().string,subject:a().string,category:a().string,is_system:a().bool,is_default:a().bool,is_active:a().bool})),loading:a().bool,error:a().string,onSelect:a().func,onDelete:a().func,onDuplicate:a().func,onReset:a().func,onCreate:a().func};const d=(0,i.jsx)(l.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,i.jsx)(l.Path,{d:"M11 12.5V17.5H12.5V12.5H17.5V11H12.5V6H11V11H6V12.5H11Z"})});function m({placeholders:r={},onSelect:n,buttonLabel:a,compact:l=!1,showSearch:o=!1}){const[s,c]=(0,e.useState)(!1),[u,p]=(0,e.useState)(""),m=window.rpEmailData?.i18n||{},h=(0,e.useMemo)(()=>{if(!u)return r;const e=u.toLowerCase(),t={};return Object.entries(r).forEach(([r,n])=>{if(!n.items)return;const a={};Object.entries(n.items).forEach(([t,r])=>{const n=t.toLowerCase().includes(e),l=r.label?.toLowerCase().includes(e),i=r.description?.toLowerCase().includes(e);(n||l||i)&&(a[t]=r)}),Object.keys(a).length>0&&(t[r]={...n,items:a})}),t},[r,u]),f=e=>{n&&n(e),l&&c(!1)};return l?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(t.Button,{icon:d,variant:"secondary",onClick:()=>c(!s),className:"rp-placeholder-picker__trigger",children:a||m.insertPlaceholder||"Platzhalter einfügen"}),s&&(0,i.jsx)(t.Popover,{onClose:()=>c(!1),placement:"bottom-start",className:"rp-placeholder-picker__popover",children:(0,i.jsxs)("div",{className:"rp-placeholder-picker__popover-content",children:[o&&(0,i.jsx)(t.SearchControl,{value:u,onChange:p,placeholder:m.searchPlaceholders||"Suchen..."}),(0,i.jsxs)("div",{className:"rp-placeholder-picker__groups",children:[Object.entries(h).map(([e,t])=>(0,i.jsxs)("div",{className:"rp-placeholder-picker__group",children:[(0,i.jsx)("h4",{className:"rp-placeholder-picker__group-title",children:t.label||e}),(0,i.jsx)("ul",{className:"rp-placeholder-picker__items",children:Object.entries(t.items||{}).map(([e,t])=>(0,i.jsx)("li",{className:"rp-placeholder-picker__item",children:(0,i.jsxs)("button",{type:"button",className:"rp-placeholder-picker__button",onClick:()=>f(e),title:t.description||"",children:[(0,i.jsx)("code",{className:"rp-placeholder-picker__code",children:`{${e}}`}),(0,i.jsx)("span",{className:"rp-placeholder-picker__label",children:t.label||e})]})},e))})]},e)),0===Object.keys(h).length&&(0,i.jsx)("p",{className:"rp-placeholder-picker__empty",children:m.noPlaceholdersFound||"Keine Platzhalter gefunden."})]})]})})]}):(0,i.jsxs)(t.Card,{className:"rp-placeholder-picker",children:[(0,i.jsx)(t.CardHeader,{children:(0,i.jsx)("h3",{children:m.placeholders||"Platzhalter"})}),(0,i.jsxs)(t.CardBody,{children:[o&&(0,i.jsx)(t.SearchControl,{value:u,onChange:p,placeholder:m.searchPlaceholders||"Suchen..."}),(0,i.jsxs)("div",{className:"rp-placeholder-picker__groups",children:[Object.entries(h).map(([e,t])=>(0,i.jsxs)("div",{className:"rp-placeholder-picker__group",children:[(0,i.jsx)("h4",{className:"rp-placeholder-picker__group-title",children:t.label||e}),(0,i.jsx)("ul",{className:"rp-placeholder-picker__items",children:Object.entries(t.items||{}).map(([e,t])=>(0,i.jsx)("li",{className:"rp-placeholder-picker__item",children:(0,i.jsxs)("button",{type:"button",className:"rp-placeholder-picker__button",onClick:()=>f(e),title:t.description||"",children:[(0,i.jsx)("code",{className:"rp-placeholder-picker__code",children:`{${e}}`}),(0,i.jsx)("span",{className:"rp-placeholder-picker__label",children:t.label||e})]})},e))})]},e)),0===Object.keys(h).length&&(0,i.jsx)("p",{className:"rp-placeholder-picker__empty",children:m.noPlaceholdersFound||"Keine Platzhalter gefunden."})]})]})]})}m.propTypes={placeholders:a().objectOf(a().shape({label:a().string,items:a().objectOf(a().shape({label:a().string,description:a().string}))})),onSelect:a().func,buttonLabel:a().string,compact:a().bool,showSearch:a().bool};const{entries:h,setPrototypeOf:f,isFrozen:g,getPrototypeOf:b,getOwnPropertyDescriptor:y}=Object;let{freeze:_,seal:x,create:T}=Object,{apply:v,construct:w}="undefined"!=typeof Reflect&&Reflect;_||(_=function(e){return e}),x||(x=function(e){return e}),v||(v=function(e,t){for(var r=arguments.length,n=new Array(r>2?r-2:0),a=2;a<r;a++)n[a-2]=arguments[a];return e.apply(t,n)}),w||(w=function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return new e(...r)});const S=F(Array.prototype.forEach),E=F(Array.prototype.lastIndexOf),j=F(Array.prototype.pop),N=F(Array.prototype.push),C=F(Array.prototype.splice),A=F(String.prototype.toLowerCase),k=F(String.prototype.toString),R=F(String.prototype.match),D=F(String.prototype.replace),O=F(String.prototype.indexOf),L=F(String.prototype.trim),I=F(Object.prototype.hasOwnProperty),M=F(RegExp.prototype.test),P=(z=TypeError,function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return w(z,t)});var z;function F(e){return function(t){t instanceof RegExp&&(t.lastIndex=0);for(var r=arguments.length,n=new Array(r>1?r-1:0),a=1;a<r;a++)n[a-1]=arguments[a];return v(e,t,n)}}function H(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:A;f&&f(e,null);let n=t.length;for(;n--;){let a=t[n];if("string"==typeof a){const e=r(a);e!==a&&(g(t)||(t[n]=e),a=e)}e[a]=!0}return e}function B(e){for(let t=0;t<e.length;t++)I(e,t)||(e[t]=null);return e}function U(e){const t=T(null);for(const[r,n]of h(e))I(e,r)&&(Array.isArray(n)?t[r]=B(n):n&&"object"==typeof n&&n.constructor===Object?t[r]=U(n):t[r]=n);return t}function G(e,t){for(;null!==e;){const r=y(e,t);if(r){if(r.get)return F(r.get);if("function"==typeof r.value)return F(r.value)}e=b(e)}return function(){return null}}const V=_(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","search","section","select","shadow","slot","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),W=_(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","enterkeyhint","exportparts","filter","font","g","glyph","glyphref","hkern","image","inputmode","line","lineargradient","marker","mask","metadata","mpath","part","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),$=_(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),q=_(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),Y=_(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),K=_(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),Z=_(["#text"]),X=_(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","exportparts","face","for","headers","height","hidden","high","href","hreflang","id","inert","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","part","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","slot","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),J=_(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","mask-type","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),Q=_(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),ee=_(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),te=x(/\{\{[\w\W]*|[\w\W]*\}\}/gm),re=x(/<%[\w\W]*|[\w\W]*%>/gm),ne=x(/\$\{[\w\W]*/gm),ae=x(/^data-[\-\w.\u00B7-\uFFFF]+$/),le=x(/^aria-[\-\w]+$/),ie=x(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),oe=x(/^(?:\w+script|data):/i),se=x(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),ce=x(/^html$/i),ue=x(/^[a-z][.\w]*(-[.\w]+)+$/i);var pe=Object.freeze({__proto__:null,ARIA_ATTR:le,ATTR_WHITESPACE:se,CUSTOM_ELEMENT:ue,DATA_ATTR:ae,DOCTYPE_NAME:ce,ERB_EXPR:re,IS_ALLOWED_URI:ie,IS_SCRIPT_OR_DATA:oe,MUSTACHE_EXPR:te,TMPLIT_EXPR:ne});const de=function(){return"undefined"==typeof window?null:window};var me=function e(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:de();const r=t=>e(t);if(r.version="3.3.1",r.removed=[],!t||!t.document||9!==t.document.nodeType||!t.Element)return r.isSupported=!1,r;let{document:n}=t;const a=n,l=a.currentScript,{DocumentFragment:i,HTMLTemplateElement:o,Node:s,Element:c,NodeFilter:u,NamedNodeMap:p=t.NamedNodeMap||t.MozNamedAttrMap,HTMLFormElement:d,DOMParser:m,trustedTypes:f}=t,g=c.prototype,b=G(g,"cloneNode"),y=G(g,"remove"),x=G(g,"nextSibling"),v=G(g,"childNodes"),w=G(g,"parentNode");if("function"==typeof o){const e=n.createElement("template");e.content&&e.content.ownerDocument&&(n=e.content.ownerDocument)}let z,F="";const{implementation:B,createNodeIterator:te,createDocumentFragment:re,getElementsByTagName:ne}=n,{importNode:ae}=a;let le={afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]};r.isSupported="function"==typeof h&&"function"==typeof w&&B&&void 0!==B.createHTMLDocument;const{MUSTACHE_EXPR:oe,ERB_EXPR:se,TMPLIT_EXPR:ue,DATA_ATTR:me,ARIA_ATTR:he,IS_SCRIPT_OR_DATA:fe,ATTR_WHITESPACE:ge,CUSTOM_ELEMENT:be}=pe;let{IS_ALLOWED_URI:ye}=pe,_e=null;const xe=H({},[...V,...W,...$,...Y,...Z]);let Te=null;const ve=H({},[...X,...J,...Q,...ee]);let we=Object.seal(T(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),Se=null,Ee=null;const je=Object.seal(T(null,{tagCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeCheck:{writable:!0,configurable:!1,enumerable:!0,value:null}}));let Ne=!0,Ce=!0,Ae=!1,ke=!0,Re=!1,De=!0,Oe=!1,Le=!1,Ie=!1,Me=!1,Pe=!1,ze=!1,Fe=!0,He=!1,Be=!0,Ue=!1,Ge={},Ve=null;const We=H({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let $e=null;const qe=H({},["audio","video","img","source","image","track"]);let Ye=null;const Ke=H({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),Ze="http://www.w3.org/1998/Math/MathML",Xe="http://www.w3.org/2000/svg",Je="http://www.w3.org/1999/xhtml";let Qe=Je,et=!1,tt=null;const rt=H({},[Ze,Xe,Je],k);let nt=H({},["mi","mo","mn","ms","mtext"]),at=H({},["annotation-xml"]);const lt=H({},["title","style","font","a","script"]);let it=null;const ot=["application/xhtml+xml","text/html"];let st=null,ct=null;const ut=n.createElement("form"),pt=function(e){return e instanceof RegExp||e instanceof Function},dt=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!ct||ct!==e){if(e&&"object"==typeof e||(e={}),e=U(e),it=-1===ot.indexOf(e.PARSER_MEDIA_TYPE)?"text/html":e.PARSER_MEDIA_TYPE,st="application/xhtml+xml"===it?k:A,_e=I(e,"ALLOWED_TAGS")?H({},e.ALLOWED_TAGS,st):xe,Te=I(e,"ALLOWED_ATTR")?H({},e.ALLOWED_ATTR,st):ve,tt=I(e,"ALLOWED_NAMESPACES")?H({},e.ALLOWED_NAMESPACES,k):rt,Ye=I(e,"ADD_URI_SAFE_ATTR")?H(U(Ke),e.ADD_URI_SAFE_ATTR,st):Ke,$e=I(e,"ADD_DATA_URI_TAGS")?H(U(qe),e.ADD_DATA_URI_TAGS,st):qe,Ve=I(e,"FORBID_CONTENTS")?H({},e.FORBID_CONTENTS,st):We,Se=I(e,"FORBID_TAGS")?H({},e.FORBID_TAGS,st):U({}),Ee=I(e,"FORBID_ATTR")?H({},e.FORBID_ATTR,st):U({}),Ge=!!I(e,"USE_PROFILES")&&e.USE_PROFILES,Ne=!1!==e.ALLOW_ARIA_ATTR,Ce=!1!==e.ALLOW_DATA_ATTR,Ae=e.ALLOW_UNKNOWN_PROTOCOLS||!1,ke=!1!==e.ALLOW_SELF_CLOSE_IN_ATTR,Re=e.SAFE_FOR_TEMPLATES||!1,De=!1!==e.SAFE_FOR_XML,Oe=e.WHOLE_DOCUMENT||!1,Me=e.RETURN_DOM||!1,Pe=e.RETURN_DOM_FRAGMENT||!1,ze=e.RETURN_TRUSTED_TYPE||!1,Ie=e.FORCE_BODY||!1,Fe=!1!==e.SANITIZE_DOM,He=e.SANITIZE_NAMED_PROPS||!1,Be=!1!==e.KEEP_CONTENT,Ue=e.IN_PLACE||!1,ye=e.ALLOWED_URI_REGEXP||ie,Qe=e.NAMESPACE||Je,nt=e.MATHML_TEXT_INTEGRATION_POINTS||nt,at=e.HTML_INTEGRATION_POINTS||at,we=e.CUSTOM_ELEMENT_HANDLING||{},e.CUSTOM_ELEMENT_HANDLING&&pt(e.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(we.tagNameCheck=e.CUSTOM_ELEMENT_HANDLING.tagNameCheck),e.CUSTOM_ELEMENT_HANDLING&&pt(e.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(we.attributeNameCheck=e.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),e.CUSTOM_ELEMENT_HANDLING&&"boolean"==typeof e.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements&&(we.allowCustomizedBuiltInElements=e.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),Re&&(Ce=!1),Pe&&(Me=!0),Ge&&(_e=H({},Z),Te=[],!0===Ge.html&&(H(_e,V),H(Te,X)),!0===Ge.svg&&(H(_e,W),H(Te,J),H(Te,ee)),!0===Ge.svgFilters&&(H(_e,$),H(Te,J),H(Te,ee)),!0===Ge.mathMl&&(H(_e,Y),H(Te,Q),H(Te,ee))),e.ADD_TAGS&&("function"==typeof e.ADD_TAGS?je.tagCheck=e.ADD_TAGS:(_e===xe&&(_e=U(_e)),H(_e,e.ADD_TAGS,st))),e.ADD_ATTR&&("function"==typeof e.ADD_ATTR?je.attributeCheck=e.ADD_ATTR:(Te===ve&&(Te=U(Te)),H(Te,e.ADD_ATTR,st))),e.ADD_URI_SAFE_ATTR&&H(Ye,e.ADD_URI_SAFE_ATTR,st),e.FORBID_CONTENTS&&(Ve===We&&(Ve=U(Ve)),H(Ve,e.FORBID_CONTENTS,st)),e.ADD_FORBID_CONTENTS&&(Ve===We&&(Ve=U(Ve)),H(Ve,e.ADD_FORBID_CONTENTS,st)),Be&&(_e["#text"]=!0),Oe&&H(_e,["html","head","body"]),_e.table&&(H(_e,["tbody"]),delete Se.tbody),e.TRUSTED_TYPES_POLICY){if("function"!=typeof e.TRUSTED_TYPES_POLICY.createHTML)throw P('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if("function"!=typeof e.TRUSTED_TYPES_POLICY.createScriptURL)throw P('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');z=e.TRUSTED_TYPES_POLICY,F=z.createHTML("")}else void 0===z&&(z=function(e,t){if("object"!=typeof e||"function"!=typeof e.createPolicy)return null;let r=null;const n="data-tt-policy-suffix";t&&t.hasAttribute(n)&&(r=t.getAttribute(n));const a="dompurify"+(r?"#"+r:"");try{return e.createPolicy(a,{createHTML:e=>e,createScriptURL:e=>e})}catch(e){return console.warn("TrustedTypes policy "+a+" could not be created."),null}}(f,l)),null!==z&&"string"==typeof F&&(F=z.createHTML(""));_&&_(e),ct=e}},mt=H({},[...W,...$,...q]),ht=H({},[...Y,...K]),ft=function(e){N(r.removed,{element:e});try{w(e).removeChild(e)}catch(t){y(e)}},gt=function(e,t){try{N(r.removed,{attribute:t.getAttributeNode(e),from:t})}catch(e){N(r.removed,{attribute:null,from:t})}if(t.removeAttribute(e),"is"===e)if(Me||Pe)try{ft(t)}catch(e){}else try{t.setAttribute(e,"")}catch(e){}},bt=function(e){let t=null,r=null;if(Ie)e="<remove></remove>"+e;else{const t=R(e,/^[\r\n\t ]+/);r=t&&t[0]}"application/xhtml+xml"===it&&Qe===Je&&(e='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+e+"</body></html>");const a=z?z.createHTML(e):e;if(Qe===Je)try{t=(new m).parseFromString(a,it)}catch(e){}if(!t||!t.documentElement){t=B.createDocument(Qe,"template",null);try{t.documentElement.innerHTML=et?F:a}catch(e){}}const l=t.body||t.documentElement;return e&&r&&l.insertBefore(n.createTextNode(r),l.childNodes[0]||null),Qe===Je?ne.call(t,Oe?"html":"body")[0]:Oe?t.documentElement:l},yt=function(e){return te.call(e.ownerDocument||e,e,u.SHOW_ELEMENT|u.SHOW_COMMENT|u.SHOW_TEXT|u.SHOW_PROCESSING_INSTRUCTION|u.SHOW_CDATA_SECTION,null)},_t=function(e){return e instanceof d&&("string"!=typeof e.nodeName||"string"!=typeof e.textContent||"function"!=typeof e.removeChild||!(e.attributes instanceof p)||"function"!=typeof e.removeAttribute||"function"!=typeof e.setAttribute||"string"!=typeof e.namespaceURI||"function"!=typeof e.insertBefore||"function"!=typeof e.hasChildNodes)},xt=function(e){return"function"==typeof s&&e instanceof s};function Tt(e,t,n){S(e,e=>{e.call(r,t,n,ct)})}const vt=function(e){let t=null;if(Tt(le.beforeSanitizeElements,e,null),_t(e))return ft(e),!0;const n=st(e.nodeName);if(Tt(le.uponSanitizeElement,e,{tagName:n,allowedTags:_e}),De&&e.hasChildNodes()&&!xt(e.firstElementChild)&&M(/<[/\w!]/g,e.innerHTML)&&M(/<[/\w!]/g,e.textContent))return ft(e),!0;if(7===e.nodeType)return ft(e),!0;if(De&&8===e.nodeType&&M(/<[/\w]/g,e.data))return ft(e),!0;if(!(je.tagCheck instanceof Function&&je.tagCheck(n))&&(!_e[n]||Se[n])){if(!Se[n]&&St(n)){if(we.tagNameCheck instanceof RegExp&&M(we.tagNameCheck,n))return!1;if(we.tagNameCheck instanceof Function&&we.tagNameCheck(n))return!1}if(Be&&!Ve[n]){const t=w(e)||e.parentNode,r=v(e)||e.childNodes;if(r&&t)for(let n=r.length-1;n>=0;--n){const a=b(r[n],!0);a.__removalCount=(e.__removalCount||0)+1,t.insertBefore(a,x(e))}}return ft(e),!0}return e instanceof c&&!function(e){let t=w(e);t&&t.tagName||(t={namespaceURI:Qe,tagName:"template"});const r=A(e.tagName),n=A(t.tagName);return!!tt[e.namespaceURI]&&(e.namespaceURI===Xe?t.namespaceURI===Je?"svg"===r:t.namespaceURI===Ze?"svg"===r&&("annotation-xml"===n||nt[n]):Boolean(mt[r]):e.namespaceURI===Ze?t.namespaceURI===Je?"math"===r:t.namespaceURI===Xe?"math"===r&&at[n]:Boolean(ht[r]):e.namespaceURI===Je?!(t.namespaceURI===Xe&&!at[n])&&!(t.namespaceURI===Ze&&!nt[n])&&!ht[r]&&(lt[r]||!mt[r]):!("application/xhtml+xml"!==it||!tt[e.namespaceURI]))}(e)?(ft(e),!0):"noscript"!==n&&"noembed"!==n&&"noframes"!==n||!M(/<\/no(script|embed|frames)/i,e.innerHTML)?(Re&&3===e.nodeType&&(t=e.textContent,S([oe,se,ue],e=>{t=D(t,e," ")}),e.textContent!==t&&(N(r.removed,{element:e.cloneNode()}),e.textContent=t)),Tt(le.afterSanitizeElements,e,null),!1):(ft(e),!0)},wt=function(e,t,r){if(Fe&&("id"===t||"name"===t)&&(r in n||r in ut))return!1;if(Ce&&!Ee[t]&&M(me,t));else if(Ne&&M(he,t));else if(je.attributeCheck instanceof Function&&je.attributeCheck(t,e));else if(!Te[t]||Ee[t]){if(!(St(e)&&(we.tagNameCheck instanceof RegExp&&M(we.tagNameCheck,e)||we.tagNameCheck instanceof Function&&we.tagNameCheck(e))&&(we.attributeNameCheck instanceof RegExp&&M(we.attributeNameCheck,t)||we.attributeNameCheck instanceof Function&&we.attributeNameCheck(t,e))||"is"===t&&we.allowCustomizedBuiltInElements&&(we.tagNameCheck instanceof RegExp&&M(we.tagNameCheck,r)||we.tagNameCheck instanceof Function&&we.tagNameCheck(r))))return!1}else if(Ye[t]);else if(M(ye,D(r,ge,"")));else if("src"!==t&&"xlink:href"!==t&&"href"!==t||"script"===e||0!==O(r,"data:")||!$e[e])if(Ae&&!M(fe,D(r,ge,"")));else if(r)return!1;return!0},St=function(e){return"annotation-xml"!==e&&R(e,be)},Et=function(e){Tt(le.beforeSanitizeAttributes,e,null);const{attributes:t}=e;if(!t||_t(e))return;const n={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:Te,forceKeepAttr:void 0};let a=t.length;for(;a--;){const l=t[a],{name:i,namespaceURI:o,value:s}=l,c=st(i),u=s;let p="value"===i?u:L(u);if(n.attrName=c,n.attrValue=p,n.keepAttr=!0,n.forceKeepAttr=void 0,Tt(le.uponSanitizeAttribute,e,n),p=n.attrValue,!He||"id"!==c&&"name"!==c||(gt(i,e),p="user-content-"+p),De&&M(/((--!?|])>)|<\/(style|title|textarea)/i,p)){gt(i,e);continue}if("attributename"===c&&R(p,"href")){gt(i,e);continue}if(n.forceKeepAttr)continue;if(!n.keepAttr){gt(i,e);continue}if(!ke&&M(/\/>/i,p)){gt(i,e);continue}Re&&S([oe,se,ue],e=>{p=D(p,e," ")});const d=st(e.nodeName);if(wt(d,c,p)){if(z&&"object"==typeof f&&"function"==typeof f.getAttributeType)if(o);else switch(f.getAttributeType(d,c)){case"TrustedHTML":p=z.createHTML(p);break;case"TrustedScriptURL":p=z.createScriptURL(p)}if(p!==u)try{o?e.setAttributeNS(o,i,p):e.setAttribute(i,p),_t(e)?ft(e):j(r.removed)}catch(t){gt(i,e)}}else gt(i,e)}Tt(le.afterSanitizeAttributes,e,null)},jt=function e(t){let r=null;const n=yt(t);for(Tt(le.beforeSanitizeShadowDOM,t,null);r=n.nextNode();)Tt(le.uponSanitizeShadowNode,r,null),vt(r),Et(r),r.content instanceof i&&e(r.content);Tt(le.afterSanitizeShadowDOM,t,null)};return r.sanitize=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=null,l=null,o=null,c=null;if(et=!e,et&&(e="\x3c!--\x3e"),"string"!=typeof e&&!xt(e)){if("function"!=typeof e.toString)throw P("toString is not a function");if("string"!=typeof(e=e.toString()))throw P("dirty is not a string, aborting")}if(!r.isSupported)return e;if(Le||dt(t),r.removed=[],"string"==typeof e&&(Ue=!1),Ue){if(e.nodeName){const t=st(e.nodeName);if(!_e[t]||Se[t])throw P("root node is forbidden and cannot be sanitized in-place")}}else if(e instanceof s)n=bt("\x3c!----\x3e"),l=n.ownerDocument.importNode(e,!0),1===l.nodeType&&"BODY"===l.nodeName||"HTML"===l.nodeName?n=l:n.appendChild(l);else{if(!Me&&!Re&&!Oe&&-1===e.indexOf("<"))return z&&ze?z.createHTML(e):e;if(n=bt(e),!n)return Me?null:ze?F:""}n&&Ie&&ft(n.firstChild);const u=yt(Ue?e:n);for(;o=u.nextNode();)vt(o),Et(o),o.content instanceof i&&jt(o.content);if(Ue)return e;if(Me){if(Pe)for(c=re.call(n.ownerDocument);n.firstChild;)c.appendChild(n.firstChild);else c=n;return(Te.shadowroot||Te.shadowrootmode)&&(c=ae.call(a,c,!0)),c}let p=Oe?n.outerHTML:n.innerHTML;return Oe&&_e["!doctype"]&&n.ownerDocument&&n.ownerDocument.doctype&&n.ownerDocument.doctype.name&&M(ce,n.ownerDocument.doctype.name)&&(p="<!DOCTYPE "+n.ownerDocument.doctype.name+">\n"+p),Re&&S([oe,se,ue],e=>{p=D(p,e," ")}),z&&ze?z.createHTML(p):p},r.setConfig=function(){dt(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}),Le=!0},r.clearConfig=function(){ct=null,Le=!1},r.isValidAttribute=function(e,t,r){ct||dt({});const n=st(e),a=st(t);return wt(n,a,r)},r.addHook=function(e,t){"function"==typeof t&&N(le[e],t)},r.removeHook=function(e,t){if(void 0!==t){const r=E(le[e],t);return-1===r?void 0:C(le[e],r,1)[0]}return j(le[e])},r.removeHooks=function(e){le[e]=[]},r.removeAllHooks=function(){le={afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}},r}();const he={ALLOWED_TAGS:["p","br","strong","em","a","ul","ol","li"],ALLOWED_ATTR:["href","target","rel"]};function fe({subject:e="",body:r="",recipient:n=""}){const a=window.rpEmailData?.i18n||{};return(0,i.jsx)("div",{className:"rp-email-preview",children:(0,i.jsxs)(t.Card,{children:[(0,i.jsx)(t.CardHeader,{children:(0,i.jsx)("h3",{children:a.preview||"Vorschau"})}),(0,i.jsxs)(t.CardBody,{children:[(0,i.jsxs)("div",{className:"rp-email-preview__envelope",children:[n&&(0,i.jsxs)("div",{className:"rp-email-preview__to",children:[(0,i.jsxs)("span",{className:"rp-email-preview__label",children:[a.to||"An",":"]}),(0,i.jsx)("span",{className:"rp-email-preview__value",children:n})]}),(0,i.jsxs)("div",{className:"rp-email-preview__subject",children:[(0,i.jsxs)("span",{className:"rp-email-preview__label",children:[a.subject||"Betreff",":"]}),(0,i.jsx)("span",{className:"rp-email-preview__value",children:e||(0,i.jsx)("em",{className:"rp-email-preview__placeholder",children:a.noSubject||"(Kein Betreff)"})})]})]}),(0,i.jsx)("div",{className:"rp-email-preview__body",children:r?(0,i.jsx)("div",{className:"rp-email-preview__content",dangerouslySetInnerHTML:{__html:(e=>{if(!e)return"";let t=e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\*\*(.+?)\*\*/g,"<strong>$1</strong>").replace(/\*(.+?)\*/g,"<em>$1</em>").replace(/\[([^\]]+)\]\(([^)]+)\)/g,(e,t,r)=>{const n=t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;");return`<a href="${/^https?:\/\//.test(r)?r:"#"}" target="_blank" rel="noopener noreferrer">${n}</a>`}).replace(/\n\n/g,"</p><p>").replace(/\n/g,"<br>");return me.sanitize(`<p>${t}</p>`,he)})(r)}}):(0,i.jsx)("p",{className:"rp-email-preview__placeholder",children:a.noContent||"(Kein Inhalt)"})})]})]})})}function ge(e,t,r={}){const{escape:n=!0}=r;if(!e)return"";if(!t||"object"!=typeof t)return e;let a=e;return Object.entries(t).forEach(([e,t])=>{const r=e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),l=new RegExp(`\\{${r}\\}`,"g"),i=n?null==(o=t)?"":String(o).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;"):String(t);var o;a=a.replace(l,i)}),a}function be({template:r=null,placeholders:n={},previewValues:a={},saving:l=!1,error:o=null,onSave:s,onCancel:c}){const[u,p]=(0,e.useState)({name:"",subject:"",body:"",category:"custom",is_active:!0}),[d,h]=(0,e.useState)("edit"),[f,g]=(0,e.useState)({}),b=window.rpEmailData?.i18n||{},y=b.categories||{},_=!r?.id,x=r?.is_system||!1,T=Object.entries(y).filter(([e])=>!_||"system"!==e).map(([e,t])=>({value:e,label:t}));(0,e.useEffect)(()=>{p(r?{name:r.name||"",subject:r.subject||"",body:r.body||"",category:r.category||"custom",is_active:!1!==r.is_active}:{name:"",subject:"",body:"",category:"custom",is_active:!0}),g({})},[r]);const v=(0,e.useCallback)((e,t)=>{p(r=>({...r,[e]:t})),g(t=>{if(!t[e])return t;const r={...t};return delete r[e],r})},[]),w=(0,e.useCallback)((e,t="body")=>{const r=`{${e}}`;p(e=>{const n=e[t]||"";return{...e,[t]:n+r}})},[]),S=(0,e.useCallback)(()=>{const e={};return u.name.trim()?u.name.length>100&&(e.name=`${b.nameTooLong||"Name zu lang"} (max. 100)`):e.name=b.nameRequired||"Name ist erforderlich",u.subject.trim()?u.subject.length>255&&(e.subject=`${b.subjectTooLong||"Betreff zu lang"} (max. 255)`):e.subject=b.subjectRequired||"Betreff ist erforderlich",u.body.trim()?u.body.length>5e4&&(e.body=`${b.bodyTooLong||"Inhalt zu lang"} (max. 50000)`):e.body=b.bodyRequired||"Inhalt ist erforderlich",g(e),0===Object.keys(e).length},[u,b]),E=(0,e.useCallback)(()=>{S()&&s&&s(u)},[u,S,s]),j=(0,e.useCallback)(e=>ge(e,a),[a]);return(0,i.jsxs)("div",{className:"rp-template-editor",children:[o&&(0,i.jsx)(t.Notice,{status:"error",isDismissible:!1,children:o}),(0,i.jsxs)(t.Card,{children:[(0,i.jsx)(t.CardHeader,{children:(0,i.jsxs)(t.Flex,{children:[(0,i.jsx)(t.FlexItem,{children:(0,i.jsx)("h2",{children:_?b.newTemplate||"Neues Template":b.editTemplate||"Template bearbeiten"})}),(0,i.jsx)(t.FlexItem,{children:(0,i.jsxs)("div",{className:"rp-template-editor__tabs",children:[(0,i.jsx)(t.Button,{variant:"edit"===d?"primary":"secondary",onClick:()=>h("edit"),children:b.edit||"Bearbeiten"}),(0,i.jsx)(t.Button,{variant:"preview"===d?"primary":"secondary",onClick:()=>h("preview"),children:b.preview||"Vorschau"})]})})]})}),(0,i.jsxs)(t.CardBody,{children:["edit"===d?(0,i.jsxs)("div",{className:"rp-template-editor__form",children:[(0,i.jsxs)("div",{className:"rp-template-editor__main",children:[(0,i.jsx)(t.TextControl,{label:b.name||"Name",value:u.name,onChange:e=>v("name",e),disabled:x,help:f.name,className:f.name?"has-error":""}),(0,i.jsxs)(t.Flex,{children:[(0,i.jsx)(t.FlexItem,{isBlock:!0,children:(0,i.jsx)(t.SelectControl,{label:b.category||"Kategorie",value:u.category,options:T,onChange:e=>v("category",e),disabled:x})}),(0,i.jsx)(t.FlexItem,{children:(0,i.jsx)(t.ToggleControl,{label:b.active||"Aktiv",checked:u.is_active,onChange:e=>v("is_active",e)})})]}),(0,i.jsxs)("div",{className:"rp-template-editor__subject-row",children:[(0,i.jsx)(t.TextControl,{label:b.subject||"Betreff",value:u.subject,onChange:e=>v("subject",e),help:f.subject,className:f.subject?"has-error":""}),(0,i.jsx)(m,{placeholders:n,onSelect:e=>w(e,"subject"),buttonLabel:b.insertPlaceholder||"Platzhalter",compact:!0})]}),(0,i.jsx)("div",{className:"rp-template-editor__body-row",children:(0,i.jsx)(t.TextareaControl,{label:b.body||"Inhalt",value:u.body,onChange:e=>v("body",e),rows:15,help:f.body,className:f.body?"has-error":""})})]}),(0,i.jsx)("div",{className:"rp-template-editor__sidebar",children:(0,i.jsx)(m,{placeholders:n,onSelect:e=>w(e,"body"),showSearch:!0})})]}):(0,i.jsx)(fe,{subject:j(u.subject),body:j(u.body)}),(0,i.jsxs)("div",{className:"rp-template-editor__actions",children:[(0,i.jsx)(t.Button,{variant:"secondary",onClick:c,disabled:l,children:b.cancel||"Abbrechen"}),(0,i.jsx)(t.Button,{variant:"primary",onClick:E,disabled:l,children:l?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(t.Spinner,{}),b.saving||"Speichern..."]}):b.save||"Speichern"})]})]})]})]})}fe.propTypes={subject:a().string,body:a().string,recipient:a().string},be.propTypes={template:a().shape({id:a().number,name:a().string,subject:a().string,body:a().string,category:a().string,is_active:a().bool,is_system:a().bool}),placeholders:a().object,previewValues:a().object,saving:a().bool,error:a().string,onSave:a().func.isRequired,onCancel:a().func.isRequired},l.SVG,l.Path,a().arrayOf(a().shape({id:a().number.isRequired,name:a().string,subject:a().string,body:a().string})),a().object,a().object,a().shape({email:a().string,name:a().string}),a().number,a().bool,a().string,a().func.isRequired,a().func.isRequired,l.SVG,l.Path,l.SVG,l.Path,a().oneOf(["sent","failed","pending","scheduled","cancelled"]),a().arrayOf(a().shape({id:a().number.isRequired,recipient_email:a().string,subject:a().string,status:a().string,sent_at:a().string,created_at:a().string,scheduled_at:a().string,can_cancel:a().bool,body:a().string,body_html:a().string,error_message:a().string})),a().bool,a().string,a().shape({total:a().number,pages:a().number,page:a().number,perPage:a().number}),a().func,a().func,a().func;class ye extends e.Component{constructor(e){super(e),this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,t){console.error("React Error Boundary caught an error:",e,t),this.setState({error:e,errorInfo:t})}handleReload=()=>{window.location.reload()};handleRetry=()=>{this.setState({hasError:!1,error:null,errorInfo:null})};render(){const{hasError:e,error:r}=this.state,{children:n,fallback:a}=this.props,l=window.rpEmailData?.i18n||{};return e?a||(0,i.jsx)("div",{className:"rp-error-boundary",children:(0,i.jsxs)(t.Notice,{status:"error",isDismissible:!1,children:[(0,i.jsx)("p",{children:(0,i.jsx)("strong",{children:l.errorOccurred||"Ein Fehler ist aufgetreten"})}),(0,i.jsx)("p",{children:l.errorDescription||"Die Anwendung konnte nicht geladen werden. Bitte versuchen Sie es erneut."}),r?.message&&(0,i.jsxs)("details",{className:"rp-error-boundary__details",children:[(0,i.jsx)("summary",{children:l.errorDetails||"Fehler-Details"}),(0,i.jsx)("pre",{children:r.message})]}),(0,i.jsxs)("div",{className:"rp-error-boundary__actions",children:[(0,i.jsx)(t.Button,{variant:"secondary",onClick:this.handleRetry,children:l.retry||"Erneut versuchen"}),(0,i.jsx)(t.Button,{variant:"primary",onClick:this.handleReload,children:l.reloadPage||"Seite neu laden"})]})]})}):n}}const _e=window.wp.apiFetch;var xe=r.n(_e);function Te(e,t,r="Ein Fehler ist aufgetreten"){return"AbortError"===e?.name||(function(e){return"rest_cookie_invalid_nonce"===e?.code||"rest_forbidden"===e?.code||401===e?.data?.status||403===e?.data?.status}(e)?(console.warn("Authentication error, reloading page..."),window.location.reload(),!0):(t&&t(e?.message||r),!1))}function ve(){const[r,n]=(0,e.useState)("list"),[a,l]=(0,e.useState)(null),[o,s]=(0,e.useState)(null),c=(0,e.useRef)(null),u=window.rpEmailData?.i18n||{},{templates:d,loading:m,error:h,saving:f,createTemplate:g,updateTemplate:b,deleteTemplate:y,duplicateTemplate:_,resetTemplate:x}=function(t={}){const[r,n]=(0,e.useState)([]),[a,l]=(0,e.useState)(!0),[i,o]=(0,e.useState)(null),[s,c]=(0,e.useState)(!1),u=t?.category,p=window.rpEmailData?.i18n||{},d=p.errorLoading||"Fehler beim Laden der Templates",m=p.errorSaving||"Fehler beim Speichern",h=p.errorDeleting||"Fehler beim Löschen",f=(0,e.useRef)(null),g=(0,e.useRef)(!0),b=(0,e.useCallback)(async()=>{f.current&&f.current.abort(),f.current=new AbortController;try{l(!0),o(null);let e="/recruiting/v1/email-templates";const t=new URLSearchParams;u&&t.append("category",u),t.toString()&&(e+="?"+t.toString());const r=await xe()({path:e,signal:f.current.signal});g.current&&n(r.items||r||[])}catch(e){if("AbortError"===e?.name)return;g.current&&!Te(e,o,d)&&console.error("Error fetching templates:",e)}finally{g.current&&l(!1)}},[u,d]);(0,e.useEffect)(()=>(g.current=!0,b(),()=>{g.current=!1,f.current&&f.current.abort()}),[b]);const y=(0,e.useCallback)(async e=>{try{c(!0),o(null);const t=await xe()({path:"/recruiting/v1/email-templates",method:"POST",data:e});if(!g.current)return null;const r=t.template||t;return n(e=>[r,...e]),r}catch(e){return g.current?(Te(e,o,m)||console.error("Error creating template:",e),null):null}finally{g.current&&c(!1)}},[m]),_=(0,e.useCallback)(async(e,t)=>{try{c(!0),o(null);const r=await xe()({path:`/recruiting/v1/email-templates/${e}`,method:"PATCH",data:t});if(!g.current)return null;const a=r.template||r;return n(t=>t.map(t=>t.id===e?a:t)),a}catch(e){return g.current?(Te(e,o,m)||console.error("Error updating template:",e),null):null}finally{g.current&&c(!1)}},[m]),x=(0,e.useCallback)(async e=>{const t=[...r];try{return c(!0),o(null),n(t=>t.filter(t=>t.id!==e)),await xe()({path:`/recruiting/v1/email-templates/${e}`,method:"DELETE"}),!0}catch(e){return!!g.current&&(n(t),Te(e,o,h)||console.error("Error deleting template:",e),!1)}finally{g.current&&c(!1)}},[r,h]),T=(0,e.useCallback)(async(e,t="")=>{try{c(!0),o(null);const r=await xe()({path:`/recruiting/v1/email-templates/${e}/duplicate`,method:"POST",data:{name:t}});if(!g.current)return null;const a=r.template||r;return n(e=>[a,...e]),a}catch(e){return g.current?(Te(e,o,m)||console.error("Error duplicating template:",e),null):null}finally{g.current&&c(!1)}},[m]),v=(0,e.useCallback)(async e=>{try{c(!0),o(null);const t=await xe()({path:`/recruiting/v1/email-templates/${e}/reset`,method:"POST"});if(!g.current)return null;const r=t.template||t;return n(t=>t.map(t=>t.id===e?r:t)),r}catch(e){return g.current?(Te(e,o,m)||console.error("Error resetting template:",e),null):null}finally{g.current&&c(!1)}},[m]);return{templates:r,loading:a,error:i,saving:s,fetchTemplates:b,createTemplate:y,updateTemplate:_,deleteTemplate:x,duplicateTemplate:T,resetTemplate:v,refetch:b}}(),{placeholders:T,previewValues:v}=function(){const[t,r]=(0,e.useState)({}),[n,a]=(0,e.useState)({}),[l,i]=(0,e.useState)(!0),[o,s]=(0,e.useState)(null),c=(window.rpEmailData?.i18n||{}).errorLoading||"Fehler beim Laden der Platzhalter",u=(0,e.useRef)(null),p=(0,e.useRef)(!0),d=(0,e.useCallback)(async()=>{u.current&&u.current.abort(),u.current=new AbortController;try{i(!0),s(null);const e=await xe()({path:"/recruiting/v1/email-templates/placeholders",signal:u.current.signal});p.current&&(r(e.groups||{}),a(e.preview_values||{}))}catch(e){if("AbortError"===e?.name)return;p.current&&!Te(e,s,c)&&console.error("Error fetching placeholders:",e)}finally{p.current&&i(!1)}},[c]);(0,e.useEffect)(()=>(p.current=!0,d(),()=>{p.current=!1,u.current&&u.current.abort()}),[d]);const m=(0,e.useCallback)(e=>ge(e,n),[n]),h=(0,e.useCallback)(()=>{const e=[];return Object.values(t).forEach(t=>{t.items&&Object.keys(t.items).forEach(t=>e.push(t))}),e},[t]);return{placeholders:t,previewValues:n,loading:l,error:o,fetchPlaceholders:d,replacePlaceholders:m,getAllPlaceholderKeys:h,refetch:d}}();(0,e.useEffect)(()=>()=>{c.current&&clearTimeout(c.current)},[]);const w=(0,e.useCallback)((e,t="success")=>{c.current&&clearTimeout(c.current),s({message:e,type:t}),c.current=setTimeout(()=>{s(null),c.current=null},3e3)},[]),S=(0,e.useCallback)(e=>{l(e),n("edit")},[]),E=(0,e.useCallback)(()=>{l(null),n("create")},[]),j=(0,e.useCallback)(async e=>{let t;t=a?.id?await b(a.id,e):await g(e),t&&(w(u.templateSaved||"Template wurde gespeichert."),n("list"),l(null))},[a,b,g,w,u.templateSaved]),N=(0,e.useCallback)(async e=>{await y(e)&&w(u.templateDeleted||"Template wurde gelöscht.")},[y,w,u.templateDeleted]),C=(0,e.useCallback)(async e=>{await _(e)&&w(u.templateDuplicated||"Template wurde dupliziert.")},[_,w,u.templateDuplicated]),A=(0,e.useCallback)(async e=>{await x(e)&&w(u.templateReset||"Template wurde zurückgesetzt.")},[x,w,u.templateReset]),k=(0,e.useCallback)(()=>{n("list"),l(null)},[]);return(0,i.jsxs)("div",{className:"rp-email-templates-app",children:[o&&(0,i.jsx)(t.Notice,{status:o.type,isDismissible:!0,onRemove:()=>s(null),className:"rp-notification",children:o.message}),"list"===r&&(0,i.jsx)(p,{templates:d,loading:m,error:h,onSelect:S,onDelete:N,onDuplicate:C,onReset:A,onCreate:E}),("edit"===r||"create"===r)&&(0,i.jsx)(be,{template:a,placeholders:T,previewValues:v,saving:f,error:h,onSave:j,onCancel:k})]})}document.addEventListener("DOMContentLoaded",()=>{const t=document.getElementById("rp-email-templates-app");t&&(0,e.render)((0,i.jsx)(ye,{children:(0,i.jsx)(ve,{})}),t)})})()})();